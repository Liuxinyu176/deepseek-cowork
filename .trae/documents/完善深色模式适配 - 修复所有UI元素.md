## 问题分析
当前主题适配不完整，main.py 中存在大量硬编码颜色值，导致以下元素在深色模式下显示异常：
- 历史会话按钮（选中/未选中状态）
- 工作区选择器背景
- 右侧边栏背景
- 文件树选中项
- 预览区域头部
- 工具详情标签
- 侧边栏按钮
- 聊天区域文本颜色
- 技能卡片
- 各种标签和按钮

## 解决方案

### 1. 修改 theme.py
- 添加 `get_theme_colors()` 函数，根据当前主题返回对应的颜色字典
- 添加动态样式生成函数，为常见UI元素生成主题适配的样式

### 2. 修改 main.py
- 将所有硬编码颜色替换为动态获取的主题颜色
- 在 `_on_theme_changed` 回调中添加更多UI元素的更新逻辑
- 为历史会话按钮、工作区选择器等添加主题感知能力

### 3. 主要修改点
- 历史会话按钮：根据主题切换背景和文字颜色
- 工作区选择器容器：适配深色背景
- 右侧边栏：适配深色背景
- 文件树：选中项颜色适配
- 预览区域：头部和文本颜色适配
- 工具详情：所有标签颜色适配
- 技能卡片：背景色适配
- 设置对话框：API Key 引导文字颜色适配

### 4. 技术实现
- 使用 `theme_manager.theme_changed` 信号通知所有需要更新的UI元素
- 在 MainWindow 中添加 `update_theme_styles()` 方法统一更新样式
- 为动态创建的控件（如历史会话按钮）存储引用，以便主题变化时更新