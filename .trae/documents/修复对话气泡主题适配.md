## 问题分析

1. 我移除了 `DesignTokens` 的导入，但代码中还有 20+ 处使用它
2. 这导致运行时 NameError 错误
3. 同时需要修复对话气泡的主题适配

## 解决方案

1. 重新添加 `DesignTokens` 导入（暂时保留，后续逐步替换）
2. 修复 ChatBubble 类使用动态主题颜色
3. 添加气泡样式到 theme.py
4. 在 \_on\_theme\_changed 中更新已有气泡样式

## 问题分析

ChatBubble 类中使用了大量静态 DesignTokens，不会随主题变化：

1. 用户气泡渐变背景色 (`primary_gradient_start`, `primary_gradient_end`)
2. 思考过程按钮样式 (`bg_main`, `text_secondary`, `border`)
3. 思考容器样式 (`bg_secondary`, `border`, `accent_ai`)
4. Sub-agent 日志样式 (`bg_main`, `border`)
5. 文字颜色硬编码为 `#ffffff`

## 解决方案

1. 修改 ChatBubble 类，使用动态 `get_theme_colors()` 获取颜色
2. 为深色/亮色模式分别定义合适的渐变颜色
3. 更新所有样式为动态主题颜色
4. 在 `_on_theme_changed` 回调中添加对已有气泡的样式更新

